{
    "sourceFile": "informationmanagement/serializers/information_serializers.py",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 13,
            "patches": [
                {
                    "date": 1733485840683,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1733485850119,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -133,4 +133,24 @@\n         if image_ids:\n             instance.image.set(image_ids)\n \n         return instance\n+\n+\n+{\n+  \"title\": \"Sample Information\",\n+  \"publish_date\": \"2024-12-01T00:00:00Z\",\n+  \"active_period_start\": \"2024-12-01\",\n+  \"active_period_end\": \"2024-12-31\",\n+  \"level\": [1, 2],\n+  \"sublevel\": [3],\n+  \"course\": [4, 5],\n+  \"affiliation\": [6],\n+  \"district\": [7],\n+  \"college\": [8],\n+  \"faculty\": [9],\n+  \"information_tagging\": [10],\n+  \"information_category\": [11],\n+  \"image\": [12, 13],\n+  \"short_description\": \"Short description here\",\n+  \"description\": \"Detailed description here\"\n+}\n"
                },
                {
                    "date": 1733485855388,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -135,22 +135,22 @@\n \n         return instance\n \n \n-{\n-  \"title\": \"Sample Information\",\n-  \"publish_date\": \"2024-12-01T00:00:00Z\",\n-  \"active_period_start\": \"2024-12-01\",\n-  \"active_period_end\": \"2024-12-31\",\n-  \"level\": [1, 2],\n-  \"sublevel\": [3],\n-  \"course\": [4, 5],\n-  \"affiliation\": [6],\n-  \"district\": [7],\n-  \"college\": [8],\n-  \"faculty\": [9],\n-  \"information_tagging\": [10],\n-  \"information_category\": [11],\n-  \"image\": [12, 13],\n-  \"short_description\": \"Short description here\",\n-  \"description\": \"Detailed description here\"\n-}\n+# {\n+#   \"title\": \"Sample Information\",\n+#   \"publish_date\": \"2024-12-01T00:00:00Z\",\n+#   \"active_period_start\": \"2024-12-01\",\n+#   \"active_period_end\": \"2024-12-31\",\n+#   \"level\": [1, 2],\n+#   \"sublevel\": [3],\n+#   \"course\": [4, 5],\n+#   \"affiliation\": [6],\n+#   \"district\": [7],\n+#   \"college\": [8],\n+#   \"faculty\": [9],\n+#   \"information_tagging\": [10],\n+#   \"information_category\": [11],\n+#   \"image\": [12, 13],\n+#   \"short_description\": \"Short description here\",\n+#   \"description\": \"Detailed description here\"\n+# }\n"
                },
                {
                    "date": 1733485870897,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n from rest_framework import serializers\n-from .models import Information, Level, SubLevel, Course, Affiliation, District, College, Faculty, InformationTagging, InformationCategory, InformationGallery\n+from ..models import Information, Level, SubLevel, Course, Affiliation, District, College, Faculty, InformationTagging, InformationCategory, InformationGallery\n \n class InformationTaggingSerializer(serializers.ModelSerializer):\n     class Meta:\n         model = InformationTagging\n"
                },
                {
                    "date": 1738141138621,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,113 +30,117 @@\n         model = Information\n         fields = '__all__'\n \n \n-class InformationWriteSerializers(serializers.ModelSerializer):\n-    level = serializers.PrimaryKeyRelatedField(queryset=Level.objects.all(), many=True, required=False)\n-    sublevel = serializers.PrimaryKeyRelatedField(queryset=SubLevel.objects.all(), many=True, required=False)\n-    course = serializers.PrimaryKeyRelatedField(queryset=Course.objects.all(), many=True, required=False)\n-    affiliation = serializers.PrimaryKeyRelatedField(queryset=Affiliation.objects.all(), many=True, required=False)\n-    district = serializers.PrimaryKeyRelatedField(queryset=District.objects.all(), many=True, required=False)\n-    college = serializers.PrimaryKeyRelatedField(queryset=College.objects.all(), many=True, required=False)\n-    faculty = serializers.PrimaryKeyRelatedField(queryset=Faculty.objects.all(), many=True, required=False)\n-    information_tagging = serializers.PrimaryKeyRelatedField(queryset=InformationTagging.objects.all(), many=True, required=False)\n-    information_category = serializers.PrimaryKeyRelatedField(queryset=InformationCategory.objects.all(), many=True, required=False)\n-    image = serializers.PrimaryKeyRelatedField(queryset=InformationGallery.objects.all(), many=True, required=False)\n+class InformationWriteSerializer(serializers.ModelSerializer):\n+    \"\"\"\n+    Serializer for handling Many-to-Many fields as comma-separated values\n+    and handling binary image uploads in form-data.\n+    \"\"\"\n \n+    # Expecting image uploads as binary files in form-data\n+    image = serializers.ListField(\n+        child=serializers.ImageField(max_length=None, allow_empty_file=False, use_url=False),\n+        write_only=True,\n+        required=False\n+    )\n+\n     class Meta:\n         model = Information\n         fields = '__all__'\n \n+    def parse_comma_separated_values(self, field_name):\n+        \"\"\"\n+        Parses comma-separated values (e.g., \"1,2,3\") from form-data into a list of integers.\n+        \"\"\"\n+        field_value = self.initial_data.get(field_name, \"\")\n+        if field_value:\n+            try:\n+                return [int(pk.strip()) for pk in field_value.split(\",\") if pk.strip()]\n+            except ValueError:\n+                raise serializers.ValidationError({field_name: \"Must be a comma-separated list of integers.\"})\n+        return []\n+\n+    @transaction.atomic\n     def create(self, validated_data):\n         \"\"\"\n-        Handles creation of Information instance with related objects based on provided ids.\n+        Handles creation of Information instance with Many-to-Many fields and binary image uploads.\n         \"\"\"\n-        # Extract the related fields (ManyToMany)\n-        level_ids = validated_data.pop('level', [])\n-        sublevel_ids = validated_data.pop('sublevel', [])\n-        course_ids = validated_data.pop('course', [])\n-        affiliation_ids = validated_data.pop('affiliation', [])\n-        district_ids = validated_data.pop('district', [])\n-        college_ids = validated_data.pop('college', [])\n-        faculty_ids = validated_data.pop('faculty', [])\n-        information_tagging_ids = validated_data.pop('information_tagging', [])\n-        information_category_ids = validated_data.pop('information_category', [])\n-        image_ids = validated_data.pop('image', [])\n+        # Extract Many-to-Many relationships from form-data (comma-separated values)\n+        level_ids = self.parse_comma_separated_values('level')\n+        sublevel_ids = self.parse_comma_separated_values('sublevel')\n+        course_ids = self.parse_comma_separated_values('course')\n+        affiliation_ids = self.parse_comma_separated_values('affiliation')\n+        district_ids = self.parse_comma_separated_values('district')\n+        college_ids = self.parse_comma_separated_values('college')\n+        faculty_ids = self.parse_comma_separated_values('faculty')\n+        information_tagging_ids = self.parse_comma_separated_values('information_tagging')\n+        information_category_ids = self.parse_comma_separated_values('information_category')\n \n-        # Create the Information instance first\n+        # Extract images from validated data\n+        images = validated_data.pop('image', [])\n+\n+        # Create the Information instance\n         information = Information.objects.create(**validated_data)\n \n-        # Assign ManyToMany relationships\n-        if level_ids:\n-            information.level.set(level_ids)\n-        if sublevel_ids:\n-            information.sublevel.set(sublevel_ids)\n-        if course_ids:\n-            information.course.set(course_ids)\n-        if affiliation_ids:\n-            information.affiliation.set(affiliation_ids)\n-        if district_ids:\n-            information.district.set(district_ids)\n-        if college_ids:\n-            information.college.set(college_ids)\n-        if faculty_ids:\n-            information.faculty.set(faculty_ids)\n-        if information_tagging_ids:\n-            information.information_tagging.set(information_tagging_ids)\n-        if information_category_ids:\n-            information.information_category.set(information_category_ids)\n-        if image_ids:\n-            information.image.set(image_ids)\n+        # Assign Many-to-Many relationships\n+        information.level.set(level_ids)\n+        information.sublevel.set(sublevel_ids)\n+        information.course.set(course_ids)\n+        information.affiliation.set(affiliation_ids)\n+        information.district.set(district_ids)\n+        information.college.set(college_ids)\n+        information.faculty.set(faculty_ids)\n+        information.information_tagging.set(information_tagging_ids)\n+        information.information_category.set(information_category_ids)\n \n+        # Save image uploads\n+        for img in images:\n+            InformationGallery.objects.create(information=information, image=img)\n+\n         return information\n \n+    @transaction.atomic\n     def update(self, instance, validated_data):\n         \"\"\"\n-        Handles the update of Information instance with related objects based on provided ids.\n+        Handles updating of Information instance with Many-to-Many fields and binary image uploads.\n         \"\"\"\n-        # Extract the related fields (ManyToMany)\n-        level_ids = validated_data.pop('level', [])\n-        sublevel_ids = validated_data.pop('sublevel', [])\n-        course_ids = validated_data.pop('course', [])\n-        affiliation_ids = validated_data.pop('affiliation', [])\n-        district_ids = validated_data.pop('district', [])\n-        college_ids = validated_data.pop('college', [])\n-        faculty_ids = validated_data.pop('faculty', [])\n-        information_tagging_ids = validated_data.pop('information_tagging', [])\n-        information_category_ids = validated_data.pop('information_category', [])\n-        image_ids = validated_data.pop('image', [])\n+        # Extract Many-to-Many relationships from form-data (comma-separated values)\n+        level_ids = self.parse_comma_separated_values('level')\n+        sublevel_ids = self.parse_comma_separated_values('sublevel')\n+        course_ids = self.parse_comma_separated_values('course')\n+        affiliation_ids = self.parse_comma_separated_values('affiliation')\n+        district_ids = self.parse_comma_separated_values('district')\n+        college_ids = self.parse_comma_separated_values('college')\n+        faculty_ids = self.parse_comma_separated_values('faculty')\n+        information_tagging_ids = self.parse_comma_separated_values('information_tagging')\n+        information_category_ids = self.parse_comma_separated_values('information_category')\n \n-        # Update the fields of the Information instance\n+        # Extract images from validated data\n+        images = validated_data.pop('image', [])\n+\n+        # Update instance fields\n         for attr, value in validated_data.items():\n             setattr(instance, attr, value)\n         instance.save()\n \n-        # Update ManyToMany relationships\n-        if level_ids:\n-            instance.level.set(level_ids)\n-        if sublevel_ids:\n-            instance.sublevel.set(sublevel_ids)\n-        if course_ids:\n-            instance.course.set(course_ids)\n-        if affiliation_ids:\n-            instance.affiliation.set(affiliation_ids)\n-        if district_ids:\n-            instance.district.set(district_ids)\n-        if college_ids:\n-            instance.college.set(college_ids)\n-        if faculty_ids:\n-            instance.faculty.set(faculty_ids)\n-        if information_tagging_ids:\n-            instance.information_tagging.set(information_tagging_ids)\n-        if information_category_ids:\n-            instance.information_category.set(information_category_ids)\n-        if image_ids:\n-            instance.image.set(image_ids)\n+        # Update Many-to-Many relationships\n+        instance.level.set(level_ids)\n+        instance.sublevel.set(sublevel_ids)\n+        instance.course.set(course_ids)\n+        instance.affiliation.set(affiliation_ids)\n+        instance.district.set(district_ids)\n+        instance.college.set(college_ids)\n+        instance.faculty.set(faculty_ids)\n+        instance.information_tagging.set(information_tagging_ids)\n+        instance.information_category.set(information_category_ids)\n \n+        # Save new image uploads (append to existing images)\n+        for img in images:\n+            InformationGallery.objects.create(information=instance, image=img)\n+\n         return instance\n \n-\n # {\n #   \"title\": \"Sample Information\",\n #   \"publish_date\": \"2024-12-01T00:00:00Z\",\n #   \"active_period_start\": \"2024-12-01\",\n"
                },
                {
                    "date": 1738141162323,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,7 @@\n from rest_framework import serializers\n+from django.db import transaction\n+\n from ..models import Information, Level, SubLevel, Course, Affiliation, District, College, Faculty, InformationTagging, InformationCategory, InformationGallery\n \n class InformationTaggingSerializer(serializers.ModelSerializer):\n     class Meta:\n"
                },
                {
                    "date": 1738141558139,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         model = Information\n         fields = '__all__'\n \n \n-class InformationWriteSerializer(serializers.ModelSerializer):\n+class InformationWriteSerializers(serializers.ModelSerializer):\n     \"\"\"\n     Serializer for handling Many-to-Many fields as comma-separated values\n     and handling binary image uploads in form-data.\n     \"\"\"\n"
                },
                {
                    "date": 1738231846439,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,99 +49,99 @@\n     class Meta:\n         model = Information\n         fields = '__all__'\n \n-    def parse_comma_separated_values(self, field_name):\n-        \"\"\"\n-        Parses comma-separated values (e.g., \"1,2,3\") from form-data into a list of integers.\n-        \"\"\"\n-        field_value = self.initial_data.get(field_name, \"\")\n-        if field_value:\n-            try:\n-                return [int(pk.strip()) for pk in field_value.split(\",\") if pk.strip()]\n-            except ValueError:\n-                raise serializers.ValidationError({field_name: \"Must be a comma-separated list of integers.\"})\n-        return []\n+    # def parse_comma_separated_values(self, field_name):\n+    #     \"\"\"\n+    #     Parses comma-separated values (e.g., \"1,2,3\") from form-data into a list of integers.\n+    #     \"\"\"\n+    #     field_value = self.initial_data.get(field_name, \"\")\n+    #     if field_value:\n+    #         try:\n+    #             return [int(pk.strip()) for pk in field_value.split(\",\") if pk.strip()]\n+    #         except ValueError:\n+    #             raise serializers.ValidationError({field_name: \"Must be a comma-separated list of integers.\"})\n+    #     return []\n \n-    @transaction.atomic\n-    def create(self, validated_data):\n-        \"\"\"\n-        Handles creation of Information instance with Many-to-Many fields and binary image uploads.\n-        \"\"\"\n-        # Extract Many-to-Many relationships from form-data (comma-separated values)\n-        level_ids = self.parse_comma_separated_values('level')\n-        sublevel_ids = self.parse_comma_separated_values('sublevel')\n-        course_ids = self.parse_comma_separated_values('course')\n-        affiliation_ids = self.parse_comma_separated_values('affiliation')\n-        district_ids = self.parse_comma_separated_values('district')\n-        college_ids = self.parse_comma_separated_values('college')\n-        faculty_ids = self.parse_comma_separated_values('faculty')\n-        information_tagging_ids = self.parse_comma_separated_values('information_tagging')\n-        information_category_ids = self.parse_comma_separated_values('information_category')\n+    # @transaction.atomic\n+    # def create(self, validated_data):\n+    #     \"\"\"\n+    #     Handles creation of Information instance with Many-to-Many fields and binary image uploads.\n+    #     \"\"\"\n+    #     # Extract Many-to-Many relationships from form-data (comma-separated values)\n+    #     level_ids = self.parse_comma_separated_values('level')\n+    #     sublevel_ids = self.parse_comma_separated_values('sublevel')\n+    #     course_ids = self.parse_comma_separated_values('course')\n+    #     affiliation_ids = self.parse_comma_separated_values('affiliation')\n+    #     district_ids = self.parse_comma_separated_values('district')\n+    #     college_ids = self.parse_comma_separated_values('college')\n+    #     faculty_ids = self.parse_comma_separated_values('faculty')\n+    #     information_tagging_ids = self.parse_comma_separated_values('information_tagging')\n+    #     information_category_ids = self.parse_comma_separated_values('information_category')\n \n-        # Extract images from validated data\n-        images = validated_data.pop('image', [])\n+    #     # Extract images from validated data\n+    #     images = validated_data.pop('image', [])\n \n-        # Create the Information instance\n-        information = Information.objects.create(**validated_data)\n+    #     # Create the Information instance\n+    #     information = Information.objects.create(**validated_data)\n \n-        # Assign Many-to-Many relationships\n-        information.level.set(level_ids)\n-        information.sublevel.set(sublevel_ids)\n-        information.course.set(course_ids)\n-        information.affiliation.set(affiliation_ids)\n-        information.district.set(district_ids)\n-        information.college.set(college_ids)\n-        information.faculty.set(faculty_ids)\n-        information.information_tagging.set(information_tagging_ids)\n-        information.information_category.set(information_category_ids)\n+    #     # Assign Many-to-Many relationships\n+    #     information.level.set(level_ids)\n+    #     information.sublevel.set(sublevel_ids)\n+    #     information.course.set(course_ids)\n+    #     information.affiliation.set(affiliation_ids)\n+    #     information.district.set(district_ids)\n+    #     information.college.set(college_ids)\n+    #     information.faculty.set(faculty_ids)\n+    #     information.information_tagging.set(information_tagging_ids)\n+    #     information.information_category.set(information_category_ids)\n \n-        # Save image uploads\n-        for img in images:\n-            InformationGallery.objects.create(information=information, image=img)\n+    #     # Save image uploads\n+    #     for img in images:\n+    #         InformationGallery.objects.create(information=information, image=img)\n \n-        return information\n+    #     return information\n \n-    @transaction.atomic\n-    def update(self, instance, validated_data):\n-        \"\"\"\n-        Handles updating of Information instance with Many-to-Many fields and binary image uploads.\n-        \"\"\"\n-        # Extract Many-to-Many relationships from form-data (comma-separated values)\n-        level_ids = self.parse_comma_separated_values('level')\n-        sublevel_ids = self.parse_comma_separated_values('sublevel')\n-        course_ids = self.parse_comma_separated_values('course')\n-        affiliation_ids = self.parse_comma_separated_values('affiliation')\n-        district_ids = self.parse_comma_separated_values('district')\n-        college_ids = self.parse_comma_separated_values('college')\n-        faculty_ids = self.parse_comma_separated_values('faculty')\n-        information_tagging_ids = self.parse_comma_separated_values('information_tagging')\n-        information_category_ids = self.parse_comma_separated_values('information_category')\n+    # @transaction.atomic\n+    # def update(self, instance, validated_data):\n+    #     \"\"\"\n+    #     Handles updating of Information instance with Many-to-Many fields and binary image uploads.\n+    #     \"\"\"\n+    #     # Extract Many-to-Many relationships from form-data (comma-separated values)\n+    #     level_ids = self.parse_comma_separated_values('level')\n+    #     sublevel_ids = self.parse_comma_separated_values('sublevel')\n+    #     course_ids = self.parse_comma_separated_values('course')\n+    #     affiliation_ids = self.parse_comma_separated_values('affiliation')\n+    #     district_ids = self.parse_comma_separated_values('district')\n+    #     college_ids = self.parse_comma_separated_values('college')\n+    #     faculty_ids = self.parse_comma_separated_values('faculty')\n+    #     information_tagging_ids = self.parse_comma_separated_values('information_tagging')\n+    #     information_category_ids = self.parse_comma_separated_values('information_category')\n \n-        # Extract images from validated data\n-        images = validated_data.pop('image', [])\n+    #     # Extract images from validated data\n+    #     images = validated_data.pop('image', [])\n \n-        # Update instance fields\n-        for attr, value in validated_data.items():\n-            setattr(instance, attr, value)\n-        instance.save()\n+    #     # Update instance fields\n+    #     for attr, value in validated_data.items():\n+    #         setattr(instance, attr, value)\n+    #     instance.save()\n \n-        # Update Many-to-Many relationships\n-        instance.level.set(level_ids)\n-        instance.sublevel.set(sublevel_ids)\n-        instance.course.set(course_ids)\n-        instance.affiliation.set(affiliation_ids)\n-        instance.district.set(district_ids)\n-        instance.college.set(college_ids)\n-        instance.faculty.set(faculty_ids)\n-        instance.information_tagging.set(information_tagging_ids)\n-        instance.information_category.set(information_category_ids)\n+    #     # Update Many-to-Many relationships\n+    #     instance.level.set(level_ids)\n+    #     instance.sublevel.set(sublevel_ids)\n+    #     instance.course.set(course_ids)\n+    #     instance.affiliation.set(affiliation_ids)\n+    #     instance.district.set(district_ids)\n+    #     instance.college.set(college_ids)\n+    #     instance.faculty.set(faculty_ids)\n+    #     instance.information_tagging.set(information_tagging_ids)\n+    #     instance.information_category.set(information_category_ids)\n \n-        # Save new image uploads (append to existing images)\n-        for img in images:\n-            InformationGallery.objects.create(information=instance, image=img)\n+    #     # Save new image uploads (append to existing images)\n+    #     for img in images:\n+    #         InformationGallery.objects.create(information=instance, image=img)\n \n-        return instance\n+    #     return instance\n \n # {\n #   \"title\": \"Sample Information\",\n #   \"publish_date\": \"2024-12-01T00:00:00Z\",\n"
                },
                {
                    "date": 1738231853640,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,99 +49,99 @@\n     class Meta:\n         model = Information\n         fields = '__all__'\n \n-    # def parse_comma_separated_values(self, field_name):\n-    #     \"\"\"\n-    #     Parses comma-separated values (e.g., \"1,2,3\") from form-data into a list of integers.\n-    #     \"\"\"\n-    #     field_value = self.initial_data.get(field_name, \"\")\n-    #     if field_value:\n-    #         try:\n-    #             return [int(pk.strip()) for pk in field_value.split(\",\") if pk.strip()]\n-    #         except ValueError:\n-    #             raise serializers.ValidationError({field_name: \"Must be a comma-separated list of integers.\"})\n-    #     return []\n+    def parse_comma_separated_values(self, field_name):\n+        \"\"\"\n+        Parses comma-separated values (e.g., \"1,2,3\") from form-data into a list of integers.\n+        \"\"\"\n+        field_value = self.initial_data.get(field_name, \"\")\n+        if field_value:\n+            try:\n+                return [int(pk.strip()) for pk in field_value.split(\",\") if pk.strip()]\n+            except ValueError:\n+                raise serializers.ValidationError({field_name: \"Must be a comma-separated list of integers.\"})\n+        return []\n \n-    # @transaction.atomic\n-    # def create(self, validated_data):\n-    #     \"\"\"\n-    #     Handles creation of Information instance with Many-to-Many fields and binary image uploads.\n-    #     \"\"\"\n-    #     # Extract Many-to-Many relationships from form-data (comma-separated values)\n-    #     level_ids = self.parse_comma_separated_values('level')\n-    #     sublevel_ids = self.parse_comma_separated_values('sublevel')\n-    #     course_ids = self.parse_comma_separated_values('course')\n-    #     affiliation_ids = self.parse_comma_separated_values('affiliation')\n-    #     district_ids = self.parse_comma_separated_values('district')\n-    #     college_ids = self.parse_comma_separated_values('college')\n-    #     faculty_ids = self.parse_comma_separated_values('faculty')\n-    #     information_tagging_ids = self.parse_comma_separated_values('information_tagging')\n-    #     information_category_ids = self.parse_comma_separated_values('information_category')\n+    @transaction.atomic\n+    def create(self, validated_data):\n+        \"\"\"\n+        Handles creation of Information instance with Many-to-Many fields and binary image uploads.\n+        \"\"\"\n+        # Extract Many-to-Many relationships from form-data (comma-separated values)\n+        level_ids = self.parse_comma_separated_values('level')\n+        sublevel_ids = self.parse_comma_separated_values('sublevel')\n+        course_ids = self.parse_comma_separated_values('course')\n+        affiliation_ids = self.parse_comma_separated_values('affiliation')\n+        district_ids = self.parse_comma_separated_values('district')\n+        college_ids = self.parse_comma_separated_values('college')\n+        faculty_ids = self.parse_comma_separated_values('faculty')\n+        information_tagging_ids = self.parse_comma_separated_values('information_tagging')\n+        information_category_ids = self.parse_comma_separated_values('information_category')\n \n-    #     # Extract images from validated data\n-    #     images = validated_data.pop('image', [])\n+        # Extract images from validated data\n+        images = validated_data.pop('image', [])\n \n-    #     # Create the Information instance\n-    #     information = Information.objects.create(**validated_data)\n+        # Create the Information instance\n+        information = Information.objects.create(**validated_data)\n \n-    #     # Assign Many-to-Many relationships\n-    #     information.level.set(level_ids)\n-    #     information.sublevel.set(sublevel_ids)\n-    #     information.course.set(course_ids)\n-    #     information.affiliation.set(affiliation_ids)\n-    #     information.district.set(district_ids)\n-    #     information.college.set(college_ids)\n-    #     information.faculty.set(faculty_ids)\n-    #     information.information_tagging.set(information_tagging_ids)\n-    #     information.information_category.set(information_category_ids)\n+        # Assign Many-to-Many relationships\n+        information.level.set(level_ids)\n+        information.sublevel.set(sublevel_ids)\n+        information.course.set(course_ids)\n+        information.affiliation.set(affiliation_ids)\n+        information.district.set(district_ids)\n+        information.college.set(college_ids)\n+        information.faculty.set(faculty_ids)\n+        information.information_tagging.set(information_tagging_ids)\n+        information.information_category.set(information_category_ids)\n \n-    #     # Save image uploads\n-    #     for img in images:\n-    #         InformationGallery.objects.create(information=information, image=img)\n+        # Save image uploads\n+        for img in images:\n+            InformationGallery.objects.create(information=information, image=img)\n \n-    #     return information\n+        return information\n \n-    # @transaction.atomic\n-    # def update(self, instance, validated_data):\n-    #     \"\"\"\n-    #     Handles updating of Information instance with Many-to-Many fields and binary image uploads.\n-    #     \"\"\"\n-    #     # Extract Many-to-Many relationships from form-data (comma-separated values)\n-    #     level_ids = self.parse_comma_separated_values('level')\n-    #     sublevel_ids = self.parse_comma_separated_values('sublevel')\n-    #     course_ids = self.parse_comma_separated_values('course')\n-    #     affiliation_ids = self.parse_comma_separated_values('affiliation')\n-    #     district_ids = self.parse_comma_separated_values('district')\n-    #     college_ids = self.parse_comma_separated_values('college')\n-    #     faculty_ids = self.parse_comma_separated_values('faculty')\n-    #     information_tagging_ids = self.parse_comma_separated_values('information_tagging')\n-    #     information_category_ids = self.parse_comma_separated_values('information_category')\n+    @transaction.atomic\n+    def update(self, instance, validated_data):\n+        \"\"\"\n+        Handles updating of Information instance with Many-to-Many fields and binary image uploads.\n+        \"\"\"\n+        # Extract Many-to-Many relationships from form-data (comma-separated values)\n+        level_ids = self.parse_comma_separated_values('level')\n+        sublevel_ids = self.parse_comma_separated_values('sublevel')\n+        course_ids = self.parse_comma_separated_values('course')\n+        affiliation_ids = self.parse_comma_separated_values('affiliation')\n+        district_ids = self.parse_comma_separated_values('district')\n+        college_ids = self.parse_comma_separated_values('college')\n+        faculty_ids = self.parse_comma_separated_values('faculty')\n+        information_tagging_ids = self.parse_comma_separated_values('information_tagging')\n+        information_category_ids = self.parse_comma_separated_values('information_category')\n \n-    #     # Extract images from validated data\n-    #     images = validated_data.pop('image', [])\n+        # Extract images from validated data\n+        images = validated_data.pop('image', [])\n \n-    #     # Update instance fields\n-    #     for attr, value in validated_data.items():\n-    #         setattr(instance, attr, value)\n-    #     instance.save()\n+        # Update instance fields\n+        for attr, value in validated_data.items():\n+            setattr(instance, attr, value)\n+        instance.save()\n \n-    #     # Update Many-to-Many relationships\n-    #     instance.level.set(level_ids)\n-    #     instance.sublevel.set(sublevel_ids)\n-    #     instance.course.set(course_ids)\n-    #     instance.affiliation.set(affiliation_ids)\n-    #     instance.district.set(district_ids)\n-    #     instance.college.set(college_ids)\n-    #     instance.faculty.set(faculty_ids)\n-    #     instance.information_tagging.set(information_tagging_ids)\n-    #     instance.information_category.set(information_category_ids)\n+        # Update Many-to-Many relationships\n+        instance.level.set(level_ids)\n+        instance.sublevel.set(sublevel_ids)\n+        instance.course.set(course_ids)\n+        instance.affiliation.set(affiliation_ids)\n+        instance.district.set(district_ids)\n+        instance.college.set(college_ids)\n+        instance.faculty.set(faculty_ids)\n+        instance.information_tagging.set(information_tagging_ids)\n+        instance.information_category.set(information_category_ids)\n \n-    #     # Save new image uploads (append to existing images)\n-    #     for img in images:\n-    #         InformationGallery.objects.create(information=instance, image=img)\n+        # Save new image uploads (append to existing images)\n+        for img in images:\n+            InformationGallery.objects.create(information=instance, image=img)\n \n-    #     return instance\n+        return instance\n \n # {\n #   \"title\": \"Sample Information\",\n #   \"publish_date\": \"2024-12-01T00:00:00Z\",\n"
                },
                {
                    "date": 1738232593414,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -139,24 +139,5 @@\n         # Save new image uploads (append to existing images)\n         for img in images:\n             InformationGallery.objects.create(information=instance, image=img)\n \n-        return instance\n-\n-# {\n-#   \"title\": \"Sample Information\",\n-#   \"publish_date\": \"2024-12-01T00:00:00Z\",\n-#   \"active_period_start\": \"2024-12-01\",\n-#   \"active_period_end\": \"2024-12-31\",\n-#   \"level\": [1, 2],\n-#   \"sublevel\": [3],\n-#   \"course\": [4, 5],\n-#   \"affiliation\": [6],\n-#   \"district\": [7],\n-#   \"college\": [8],\n-#   \"faculty\": [9],\n-#   \"information_tagging\": [10],\n-#   \"information_category\": [11],\n-#   \"image\": [12, 13],\n-#   \"short_description\": \"Short description here\",\n-#   \"description\": \"Detailed description here\"\n-# }\n+        return instance\n\\ No newline at end of file\n"
                },
                {
                    "date": 1738234550142,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,112 +32,73 @@\n         model = Information\n         fields = '__all__'\n \n \n+from rest_framework import serializers\n+from django.db import transaction\n+from .models import Information, InformationGallery, InformationFiles\n+\n class InformationWriteSerializers(serializers.ModelSerializer):\n     \"\"\"\n-    Serializer for handling Many-to-Many fields as comma-separated values\n-    and handling binary image uploads in form-data.\n+    Serializer for handling binary image & file uploads in form-data.\n+    Many-to-Many fields are managed automatically by Django.\n     \"\"\"\n \n-    # Expecting image uploads as binary files in form-data\n-    image = serializers.ListField(\n-        child=serializers.ImageField(max_length=None, allow_empty_file=False, use_url=False),\n-        write_only=True,\n-        required=False\n-    )\n-\n     class Meta:\n         model = Information\n         fields = '__all__'\n \n-    def parse_comma_separated_values(self, field_name):\n-        \"\"\"\n-        Parses comma-separated values (e.g., \"1,2,3\") from form-data into a list of integers.\n-        \"\"\"\n-        field_value = self.initial_data.get(field_name, \"\")\n-        if field_value:\n-            try:\n-                return [int(pk.strip()) for pk in field_value.split(\",\") if pk.strip()]\n-            except ValueError:\n-                raise serializers.ValidationError({field_name: \"Must be a comma-separated list of integers.\"})\n-        return []\n-\n     @transaction.atomic\n     def create(self, validated_data):\n         \"\"\"\n-        Handles creation of Information instance with Many-to-Many fields and binary image uploads.\n+        Handles creation of Information instance and processes image & file uploads.\n         \"\"\"\n-        # Extract Many-to-Many relationships from form-data (comma-separated values)\n-        level_ids = self.parse_comma_separated_values('level')\n-        sublevel_ids = self.parse_comma_separated_values('sublevel')\n-        course_ids = self.parse_comma_separated_values('course')\n-        affiliation_ids = self.parse_comma_separated_values('affiliation')\n-        district_ids = self.parse_comma_separated_values('district')\n-        college_ids = self.parse_comma_separated_values('college')\n-        faculty_ids = self.parse_comma_separated_values('faculty')\n-        information_tagging_ids = self.parse_comma_separated_values('information_tagging')\n-        information_category_ids = self.parse_comma_separated_values('information_category')\n+        # Extract images and files from request's FILES\n+        images_data = []\n+        files_data = []\n \n-        # Extract images from validated data\n-        images = validated_data.pop('image', [])\n+        for key, file in self.context['request'].FILES.items():\n+            if key.startswith('images['):  # Images in array format\n+                images_data.append(file)\n+            elif key.startswith('curriculum_file_upload['):  # Files in array format\n+                files_data.append(file)\n \n         # Create the Information instance\n         information = Information.objects.create(**validated_data)\n \n-        # Assign Many-to-Many relationships\n-        information.level.set(level_ids)\n-        information.sublevel.set(sublevel_ids)\n-        information.course.set(course_ids)\n-        information.affiliation.set(affiliation_ids)\n-        information.district.set(district_ids)\n-        information.college.set(college_ids)\n-        information.faculty.set(faculty_ids)\n-        information.information_tagging.set(information_tagging_ids)\n-        information.information_category.set(information_category_ids)\n-\n         # Save image uploads\n-        for img in images:\n-            InformationGallery.objects.create(information=information, image=img)\n+        for image_file in images_data:\n+            InformationGallery.objects.create(information=information, image=image_file)\n \n+        # Save file uploads\n+        for file_item in files_data:\n+            InformationFiles.objects.create(information=information, file=file_item)\n+\n         return information\n \n     @transaction.atomic\n     def update(self, instance, validated_data):\n         \"\"\"\n-        Handles updating of Information instance with Many-to-Many fields and binary image uploads.\n+        Handles updating an Information instance and manages image & file uploads.\n         \"\"\"\n-        # Extract Many-to-Many relationships from form-data (comma-separated values)\n-        level_ids = self.parse_comma_separated_values('level')\n-        sublevel_ids = self.parse_comma_separated_values('sublevel')\n-        course_ids = self.parse_comma_separated_values('course')\n-        affiliation_ids = self.parse_comma_separated_values('affiliation')\n-        district_ids = self.parse_comma_separated_values('district')\n-        college_ids = self.parse_comma_separated_values('college')\n-        faculty_ids = self.parse_comma_separated_values('faculty')\n-        information_tagging_ids = self.parse_comma_separated_values('information_tagging')\n-        information_category_ids = self.parse_comma_separated_values('information_category')\n+        # Extract images and files from request's FILES\n+        images_data = []\n+        files_data = []\n\\ No newline at end of file\n \n-        # Extract images from validated data\n-        images = validated_data.pop('image', [])\n+        for key, file in self.context['request'].FILES.items():\n+            if key.startswith('images['):  # Images in array format\n+                images_data.append(file)\n+            elif key.startswith('curriculum_file_upload['):  # Files in array format\n+                files_data.append(file)\n \n         # Update instance fields\n-        for attr, value in validated_data.items():\n-            setattr(instance, attr, value)\n-        instance.save()\n+        instance = super().update(instance, validated_data)\n \n-        # Update Many-to-Many relationships\n-        instance.level.set(level_ids)\n-        instance.sublevel.set(sublevel_ids)\n-        instance.course.set(course_ids)\n-        instance.affiliation.set(affiliation_ids)\n-        instance.district.set(district_ids)\n-        instance.college.set(college_ids)\n-        instance.faculty.set(faculty_ids)\n-        instance.information_tagging.set(information_tagging_ids)\n-        instance.information_category.set(information_category_ids)\n-\n         # Save new image uploads (append to existing images)\n-        for img in images:\n-            InformationGallery.objects.create(information=instance, image=img)\n+        for image_file in images_data:\n+            InformationGallery.objects.create(information=instance, image=image_file)\n \n-        return instance\n+        # Save new file uploads (append to existing files)\n+        for file_item in files_data:\n+            InformationFiles.objects.create(information=instance, file=file_item)\n+\n+        return instance\n"
                },
                {
                    "date": 1738234557354,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,13 +31,8 @@\n     class Meta:\n         model = Information\n         fields = '__all__'\n \n-\n-from rest_framework import serializers\n-from django.db import transaction\n-from .models import Information, InformationGallery, InformationFiles\n-\n class InformationWriteSerializers(serializers.ModelSerializer):\n     \"\"\"\n     Serializer for handling binary image & file uploads in form-data.\n     Many-to-Many fields are managed automatically by Django.\n@@ -100,5 +95,5 @@\n         # Save new file uploads (append to existing files)\n         for file_item in files_data:\n             InformationFiles.objects.create(information=instance, file=file_item)\n \n-        return instance\n\\ No newline at end of file\n+        return instance\n"
                },
                {
                    "date": 1738234621589,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n from rest_framework import serializers\n from django.db import transaction\n \n-from ..models import Information, Level, SubLevel, Course, Affiliation, District, College, Faculty, InformationTagging, InformationCategory, InformationGallery\n+from ..models import Information, Level, SubLevel, Course, Affiliation, District, College, Faculty, InformationTagging, InformationCategory, InformationGallery,\n \n class InformationTaggingSerializer(serializers.ModelSerializer):\n     class Meta:\n         model = InformationTagging\n"
                },
                {
                    "date": 1738234630126,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n from rest_framework import serializers\n from django.db import transaction\n \n-from ..models import Information, Level, SubLevel, Course, Affiliation, District, College, Faculty, InformationTagging, InformationCategory, InformationGallery,\n+from ..models import Information, Level, SubLevel, Course, Affiliation, District, College, Faculty, InformationTagging, InformationCategory, InformationGallery, InformationFiles\n \n class InformationTaggingSerializer(serializers.ModelSerializer):\n     class Meta:\n         model = InformationTagging\n"
                }
            ],
            "date": 1733485840683,
            "name": "Commit-0",
            "content": "from rest_framework import serializers\nfrom .models import Information, Level, SubLevel, Course, Affiliation, District, College, Faculty, InformationTagging, InformationCategory, InformationGallery\n\nclass InformationTaggingSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = InformationTagging\n        fields = '__all__'\n\n\nclass InformationCategorySerializer(serializers.ModelSerializer):\n    class Meta:\n        model = InformationCategory\n        fields = '__all__'\n\n\nclass InformationGallerySerializer(serializers.ModelSerializer):\n    class Meta:\n        model = InformationGallery\n        fields = '__all__'\n\n\nclass InformationListSerializers(serializers.ModelSerializer):\n    class Meta:\n        model = Information\n        fields = '__all__'\n\n\nclass InformationRetrieveSerializers(serializers.ModelSerializer):\n    class Meta:\n        model = Information\n        fields = '__all__'\n\n\nclass InformationWriteSerializers(serializers.ModelSerializer):\n    level = serializers.PrimaryKeyRelatedField(queryset=Level.objects.all(), many=True, required=False)\n    sublevel = serializers.PrimaryKeyRelatedField(queryset=SubLevel.objects.all(), many=True, required=False)\n    course = serializers.PrimaryKeyRelatedField(queryset=Course.objects.all(), many=True, required=False)\n    affiliation = serializers.PrimaryKeyRelatedField(queryset=Affiliation.objects.all(), many=True, required=False)\n    district = serializers.PrimaryKeyRelatedField(queryset=District.objects.all(), many=True, required=False)\n    college = serializers.PrimaryKeyRelatedField(queryset=College.objects.all(), many=True, required=False)\n    faculty = serializers.PrimaryKeyRelatedField(queryset=Faculty.objects.all(), many=True, required=False)\n    information_tagging = serializers.PrimaryKeyRelatedField(queryset=InformationTagging.objects.all(), many=True, required=False)\n    information_category = serializers.PrimaryKeyRelatedField(queryset=InformationCategory.objects.all(), many=True, required=False)\n    image = serializers.PrimaryKeyRelatedField(queryset=InformationGallery.objects.all(), many=True, required=False)\n\n    class Meta:\n        model = Information\n        fields = '__all__'\n\n    def create(self, validated_data):\n        \"\"\"\n        Handles creation of Information instance with related objects based on provided ids.\n        \"\"\"\n        # Extract the related fields (ManyToMany)\n        level_ids = validated_data.pop('level', [])\n        sublevel_ids = validated_data.pop('sublevel', [])\n        course_ids = validated_data.pop('course', [])\n        affiliation_ids = validated_data.pop('affiliation', [])\n        district_ids = validated_data.pop('district', [])\n        college_ids = validated_data.pop('college', [])\n        faculty_ids = validated_data.pop('faculty', [])\n        information_tagging_ids = validated_data.pop('information_tagging', [])\n        information_category_ids = validated_data.pop('information_category', [])\n        image_ids = validated_data.pop('image', [])\n\n        # Create the Information instance first\n        information = Information.objects.create(**validated_data)\n\n        # Assign ManyToMany relationships\n        if level_ids:\n            information.level.set(level_ids)\n        if sublevel_ids:\n            information.sublevel.set(sublevel_ids)\n        if course_ids:\n            information.course.set(course_ids)\n        if affiliation_ids:\n            information.affiliation.set(affiliation_ids)\n        if district_ids:\n            information.district.set(district_ids)\n        if college_ids:\n            information.college.set(college_ids)\n        if faculty_ids:\n            information.faculty.set(faculty_ids)\n        if information_tagging_ids:\n            information.information_tagging.set(information_tagging_ids)\n        if information_category_ids:\n            information.information_category.set(information_category_ids)\n        if image_ids:\n            information.image.set(image_ids)\n\n        return information\n\n    def update(self, instance, validated_data):\n        \"\"\"\n        Handles the update of Information instance with related objects based on provided ids.\n        \"\"\"\n        # Extract the related fields (ManyToMany)\n        level_ids = validated_data.pop('level', [])\n        sublevel_ids = validated_data.pop('sublevel', [])\n        course_ids = validated_data.pop('course', [])\n        affiliation_ids = validated_data.pop('affiliation', [])\n        district_ids = validated_data.pop('district', [])\n        college_ids = validated_data.pop('college', [])\n        faculty_ids = validated_data.pop('faculty', [])\n        information_tagging_ids = validated_data.pop('information_tagging', [])\n        information_category_ids = validated_data.pop('information_category', [])\n        image_ids = validated_data.pop('image', [])\n\n        # Update the fields of the Information instance\n        for attr, value in validated_data.items():\n            setattr(instance, attr, value)\n        instance.save()\n\n        # Update ManyToMany relationships\n        if level_ids:\n            instance.level.set(level_ids)\n        if sublevel_ids:\n            instance.sublevel.set(sublevel_ids)\n        if course_ids:\n            instance.course.set(course_ids)\n        if affiliation_ids:\n            instance.affiliation.set(affiliation_ids)\n        if district_ids:\n            instance.district.set(district_ids)\n        if college_ids:\n            instance.college.set(college_ids)\n        if faculty_ids:\n            instance.faculty.set(faculty_ids)\n        if information_tagging_ids:\n            instance.information_tagging.set(information_tagging_ids)\n        if information_category_ids:\n            instance.information_category.set(information_category_ids)\n        if image_ids:\n            instance.image.set(image_ids)\n\n        return instance\n"
        }
    ]
}